# v0.32 Frontend ‚Äî Lessons (Week Calendar) + My Students + Invite Links

**–í–µ—Ä—Å—ñ—è:** 0.32  
**–†–æ–ª—å:** Frontend (—ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ BE)  
**–î–∞—Ç–∞:** 18.12.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –Ω–∞ FE; ‚è≥ –æ—á—ñ–∫—É—î—Ç—å—Å—è smoke –∑ –≥–æ—Ç–æ–≤–∏–º BE

---

## üìã SUMMARY

–£ v0.32 –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ –≤–∏–∫–æ–Ω–∞–Ω–æ —Ä–æ–±–æ—Ç–∏ –¥–ª—è Lessons-–¥–æ–º–µ–Ω—É –∑–∞ –Ω–æ–≤–∏–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º:

- –∫–∞–ª–µ–Ω–¥–∞—Ä —É—Ä–æ–∫—ñ–≤ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ –Ω–∞ week-grid (FullCalendar `timeGridWeek`) —ñ–∑ –ª–æ–∫–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–º –ø–æ—á–∞—Ç–∫–æ–º —Ç–∏–∂–Ω—è —Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –¥–Ω—ñ–≤;
- –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ/–æ–Ω–æ–≤–ª–µ–Ω–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é ‚ÄúMy Students‚Äù —è–∫ –¥–∂–µ—Ä–µ–ª–æ –≤–∏–±–æ—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∞ (endpoint v0.32 `GET /api/classroom/my-students/` —ñ–∑ fallback –Ω–∞ legacy);
- —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ UI/flow –¥–ª—è invite links —É—Ä–æ–∫—ñ–≤ (–≥–µ–Ω–µ—Ä–∞—Ü—ñ—è invite —Ç–∞ –ø–µ—Ä–µ—Ö—ñ–¥/resolve —É LessonRoom) ‚Äî –≥–æ—Ç–æ–≤–æ –¥–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó —Ç–∞ smoke-—Ç–µ—Å—Ç—ñ–≤;
- —Å—Ç–∞–±—ñ–ª—ñ–∑–æ–≤–∞–Ω–æ UX follow-teacher —Ä–µ–∂–∏–º—É presence cursors (–±–µ–∑ toast-–ø–æ–º–∏–ª–æ–∫, —á–µ—Ä–µ–∑ tooltip/indicator).

---

## ‚úÖ –í–ò–ö–û–ù–ê–ù–Ü –ó–ê–í–î–ê–ù–ù–Ø (MUST)

### FE32-1: Student selector –Ω–∞ –æ—Å–Ω–æ–≤—ñ ‚ÄúMy Students‚Äù
- –î–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö –¥–ª—è –≤–∏–±–æ—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∞ ‚Äî `ClassroomMembership` (—á–µ—Ä–µ–∑ BE endpoint).
- **Endpoint:** `GET /api/classroom/my-students/?q&limit&offset`
- –ù–∞ FE –¥–æ–¥–∞–Ω–æ fallback –Ω–∞ legacy —Å—Ç—É–¥–µ–Ω—Ç—Å—å–∫–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ –∑—ñ —Å—Ç–∞—Ä–∏–º –±–µ–∫–µ–Ω–¥–æ–º.

**–§–∞–π–ª–∏:**
- `src/modules/classroom/stores/presenceCursorsStore.ts`

### FE32-2: Lessons calendar ‚Äî week view grid + i18n
- FullCalendar –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ –Ω–∞ `timeGridWeek` —ñ–∑ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º all-day row, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ week-grid –º–∞–∫–µ—Ç—É.
- –î–æ–¥–∞–Ω–æ locale-aware:
  - `firstDay` (–ø–æ—á–∞—Ç–æ–∫ —Ç–∏–∂–Ω—è) –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –º–æ–≤–∏;
  - —Ñ–æ—Ä–º–∞—Ç –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –¥–Ω—ñ–≤ —á–µ—Ä–µ–∑ `Intl.DateTimeFormat`.
- –°—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è —É–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–∞ –∑ —Ç–æ–∫–µ–Ω–∞–º–∏ —Ç–∞ –∑—Ä–æ–±–ª–µ–Ω–∞ —Ä–æ–∑—à–∏—Ä—é–≤–∞–Ω–æ—é:
  - zebra-–∫–æ–ª–æ–Ω–∫–∏,
  - weekend shading,
  - border/grid —Å—Ç–∏–ª—ñ —á–µ—Ä–µ–∑ CSS tokens,
  - **–±–µ–∑ —Ö–∞—Ä–¥–∫–æ–¥—É** ‚ÄúSat/Sun‚Äù —Ç–∞ `nth-of-type`.

**–§–∞–π–ª–∏:**
- `src/modules/lessons/views/LessonList.vue`
- `src/modules/lessons/utils/calendarLocaleRules.js`

### FE32-3: Invite links (generate + resolve)
- –ü—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ UI-–ø–æ—Ç—ñ–∫ –¥–ª—è:
  - `POST /api/lessons/{lesson_id}/invite/` ‚Üí –æ—Ç—Ä–∏–º–∞—Ç–∏ `invite_url/token/expires_at`
  - –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è `/lesson-invites/:token` ‚Üí resolve ‚Üí —Ä–µ–¥—ñ—Ä–µ–∫—Ç —É LessonRoom (—á–µ—Ä–µ–∑ `session_uuid`).

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** smoke –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ BE v0.32 endpoints —Ç–∞ ACL.

---

## üîó ENDPOINTS (v0.32) ‚Äî —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î FE

| Area | Method | Endpoint | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|------|--------|----------|-------------|
| Classrooms | GET | `/api/classroom/my-students/` | —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Ç—å—é—Ç–æ—Ä–∞ (—á–µ—Ä–µ–∑ membership) |
| Lessons | GET | `/api/lessons?from&to` | –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–∏–π range (role inferred –Ω–∞ BE) |
| Lessons | POST | `/api/lessons/` | —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —É—Ä–æ–∫—É (membership ACL) |
| Lessons | GET | `/api/lessons/{lesson_id}/room/` | room resolve (`session_uuid`) + backfill |
| Lessons | POST | `/api/lessons/{lesson_id}/invite/` | –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ invite link |
| Lessons | GET | `/api/lesson-invites/resolve/?token=...` | resolve invite ‚Üí `{lesson_id, session_uuid}` |

---

## üß© ERROR CONTRACT (v0.32) ‚Äî –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è –Ω–∞ FE

–ù–æ–≤—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å –ø–æ–º–∏–ª–∫–∏ —É —Ñ–æ—Ä–º–∞—Ç—ñ:

```json
{ "error": "<code>", "detail": "<human-readable>" }
```

–ö–ª—é—á–æ–≤—ñ –∫–æ–¥–∏:
- `not_a_member` (403)
- `invite_invalid` (400)
- `invite_expired` (410)
- `lesson_not_found` (404)
- `forbidden` (403)

---

## üß™ Smoke checklist (–ø—ñ—Å–ª—è –≥–æ—Ç–æ–≤–æ–≥–æ BE)

### A) My Students
- –ó–∞–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—å —Ç—å—é—Ç–æ—Ä–æ–º.
- –í—ñ–¥–∫—Ä–∏—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —É—Ä–æ–∫—É.
- –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è —â–æ —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∑ `/api/classroom/my-students/`.

### B) Lesson create (membership ACL)
- –°—Ç–≤–æ—Ä–∏—Ç–∏ —É—Ä–æ–∫ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –∑—ñ —Å–ø–∏—Å–∫—É.
- –û—á—ñ–∫—É–≤–∞–Ω–Ω—è: `POST /api/lessons/` –ø–æ–≤–µ—Ä—Ç–∞—î lesson + `session_uuid`.
- –Ø–∫—â–æ 403 `not_a_member` ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ accept relation –Ω–∞ BE —Å—Ç–≤–æ—Ä—é—î membership.

### C) Room resolve
- –í—ñ–¥–∫—Ä–∏—Ç–∏ lesson ‚Üí room.
- –û—á—ñ–∫—É–≤–∞–Ω–Ω—è: `GET /api/lessons/{id}/room/` –ø–æ–≤–µ—Ä—Ç–∞—î `{lesson_id, session_uuid}`.

### D) Invite links
- –¢—å—é—Ç–æ—Ä –≥–µ–Ω–µ—Ä—É—î invite.
- –í—ñ–¥–∫—Ä–∏—Ç–∏ `/lesson-invites/:token`.
- –û—á—ñ–∫—É–≤–∞–Ω–Ω—è: resolve + —Ä–µ–¥—ñ—Ä–µ–∫—Ç —É LessonRoom.
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ `410 invite_expired` (–ø—ñ—Å–ª—è TTL) —Ç–∞ UX –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

---

## üìå –ù–æ—Ç–∞—Ç–∫–∏ / Invariants

- –î–ª—è v0.32 —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —É—Ä–æ–∫—ñ–≤ –∂–æ—Ä—Å—Ç–∫–æ –∑–∞–≤‚Äô—è–∑–∞–Ω–µ –Ω–∞ `ClassroomMembership` (active). –Ø–∫—â–æ student‚Üîtutor relation –Ω–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ membership –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ, —É—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–µ–º–æ–∂–ª–∏–≤–æ (403 `not_a_member`).

---

## ‚è≥ –í—ñ–¥–∫–ª–∞–¥–µ–Ω–æ —É v0.33

- –ü–æ–≤–Ω–∏–π smoke –ø—Ä–æ–≥—ñ–Ω (–ª–æ–∫–∞–ª—å–Ω–æ) –ø–æ –ø—É–Ω–∫—Ç–∞—Ö A‚ÄìD –∑ —Ä–µ–∞–ª—å–Ω–∏–º –±–µ–∫–µ–Ω–¥–æ–º.
- –ü–æ–ª—ñ—Ä—É–≤–∞–Ω–Ω—è UX/edge-cases –¥–ª—è invite resolve (expired/invalid) –ø—ñ—Å–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó.
- –ë—É–¥—å-—è–∫—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –Ω–∞–≤–∫–æ–ª–æ relations ‚Üí membership (—è–∫—â–æ –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –∑–º—ñ–Ω–∞ –±–µ–∫–µ–Ω–¥—É/—Ñ–ª–æ—É).
