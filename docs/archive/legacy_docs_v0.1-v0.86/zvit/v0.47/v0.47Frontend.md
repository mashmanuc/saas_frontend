# v0.47.0 Frontend ‚Äî Click UX Foundation

**–†–µ–ª—ñ–∑:** v0.47.0 (Foundation)  
**–†–æ–ª—å:** Frontend  
**–î–∞—Ç–∞:** 23.12.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (FE-1..FE-3 + Checkpoint 1)

---

## üìã SUMMARY
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ø–æ–≤–Ω–∏–π –∫–ª—ñ–∫-—Ñ–ª–æ—É –∫–∞–ª–µ–Ω–¥–∞—Ä—è: **hover ‚Üí click ‚Üí popover ‚Üí draft ‚Üí apply**.
- –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ Pinia `draftStore` –∑ bulk apply —á–µ—Ä–µ–∑ `POST /api/booking/availability/bulk` (–∫–æ–Ω—Ç—Ä–∞–∫—Ç v0.47).
- –î–æ–¥–∞–Ω–æ `CalendarPopover` –∑ –¥—ñ—è–º–∏ Set Available / Set Blocked / Clear Draft / Book Lesson.
- –°—Ç–≤–æ—Ä–µ–Ω–æ `DraftToolbar` –∑ UX –¥–ª—è pending changes (reset/apply, toasts, partial success).
- –£—Å—ñ –ø–æ–≤ º—è–∑–∞–Ω—ñ —é–Ω—ñ—Ç-—Ç–µ—Å—Ç–∏ –∑–µ–ª–µ–Ω—ñ (`npm run test -- CalendarCell DraftToolbar draftStore`).

---

## ‚úÖ FE-1: Click Handlers
| –ü—É–Ω–∫—Ç | –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è |
|-------|-------------|
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ | `CalendarCell.vue`, `CellGrid.vue`, `CalendarCellGrid.vue` |
| –û—Å–Ω–æ–≤–Ω–µ | `cellClick` emit –∑ payload (cell + MouseEvent), aria-—Ä–æ–ª—ñ, hover/focus —Å—Ç–∏–ª—ñ. |
| Acceptance | Hover –µ—Ñ–µ–∫—Ç —É `/tutor/calendar`, console.log –¥–∞–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–∫–∏. |
| –¢–µ—Å—Ç–∏ | `tests/modules/booking/components/CalendarCell.spec.ts` (–Ω–æ–≤—ñ –∫–µ–π—Å–∏ –Ω–∞ emit/readOnly). |

---

## ‚úÖ FE-2: Calendar Popover
| –ü—É–Ω–∫—Ç | –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è |
|-------|-------------|
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | `CalendarPopover.vue` (Teleport + Transition). |
| –î—ñ—ó | Set Available / Set Blocked / Clear Draft / Book Lesson (—á–µ—Ä–µ–∑ `draftStore` + –µ–º—ñ—Å—ñ—ó). |
| UX | –ü–æ–∑–∏—Ü—ñ—é–≤–∞–Ω–Ω—è –∑–∞ anchor, –∞–≤—Ç–æ–∫–æ—Ä–µ–∫—Ü—ñ—è –ø–æ –∫—Ä–∞—è—Ö, –∑–∞–∫—Ä–∏—Ç—Ç—è –ø–æ Escape/–∫–ª—ñ–∫—É –Ω–∞–∑–æ–≤–Ω—ñ, fade-anim. |
| –¢–µ—Å—Ç–∏ | `tests/modules/booking/components/CalendarPopover.spec.ts` –ø–æ–∫—Ä–∏–≤–∞—î –≤—Å—ñ –¥—ñ—ó, –ø–æ–∑–∏—Ü—ñ—é–≤–∞–Ω–Ω—è –π close. |
| Manual checkpoint | –ü–æ–ø–æ–≤–µ—Ä –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è/–∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è, –∫–Ω–æ–ø–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å, draft –¥–æ–¥–∞—î—Ç—å—Å—è. |

---

## ‚úÖ FE-3: Draft Store & Toolbar
| –ü—É–Ω–∫—Ç | –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è |
|-------|-------------|
| Store | `draftStore.ts`: Map-state, `patchCount`, `hasPendingChanges`, `applyChanges()` ‚Üí `bookingApi.bulkAvailability`. |
| Toolbar | `DraftToolbar.vue`: pending counter, Reset/Apply, toast-–Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, loading state. |
| –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è | `CalendarCellGrid.vue` –Ω–∞–∫–ª–∞–¥–∞—î –¥—Ä–∞—Ñ—Ç–∏ –Ω–∞ `calendarStore.effectiveCells`; `TutorCalendarView.vue` –ø–æ–∫–∞–∑—É—î `DraftToolbar` –≤ click-mode. |
| Testing | `tests/modules/booking/stores/draftStore.spec.ts`, `.../DraftToolbar.spec.ts` (–º–æ–∫ `useToast`). |
| Checkpoint | "Set Available" –Ω–∞ 3 –∫–ª—ñ—Ç–∏–Ω–∫–∏ ‚Üí toolbar "3 pending changes" ‚Üí Apply ‚Üí API ‚Üí toast success. |

---

## üîå API / –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∏
| Flow | Endpoint | –í–∏–∫–ª–∏–∫ |
|------|----------|--------|
| Bulk apply drafts | `POST /api/booking/availability/bulk` | `bookingApi.bulkAvailability({ changes })` |
| Popover book action | (future FE-8) | –µ–º—ñ—Å—ñ—è `bookLesson` (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è ManualBookingModal) |

–ü–æ–º–∏–ª–∫–∏/–∫–æ–¥–∏ –º–∞–ø–ª—è—Ç—å—Å—è –∑–≥—ñ–¥–Ω–æ `API_CONTRACTS_v047.md` (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `booking_exists` ‚Üí toast warning).

---

## üß™ –¢–ï–°–¢–ò
```bash
npm run test -- CalendarCell DraftToolbar draftStore # ‚úÖ 40/40
```
Manual checkpoints –≤–∏–∫–æ–Ω–∞–Ω–æ (hover/click, popover actions, draft ‚Üí apply).

---

## ‚úÖ –í–ò–°–ù–û–í–û–ö
FE-1..FE-3 –∑–∞–≤–µ—Ä—à–µ–Ω—ñ, —á–µ–∫–ø–æ—ñ–Ω—Ç 1 –≤–∏–∫–æ–Ω–∞–Ω–æ. –ö–∞–ª–µ–Ω–¥–∞—Ä —É click-mode –≥–æ—Ç–æ–≤–∏–π –¥–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏ (FE-7+). Next step –∑–∞ roadmap: **FE-7 Marketplace Calendar Widget**.
