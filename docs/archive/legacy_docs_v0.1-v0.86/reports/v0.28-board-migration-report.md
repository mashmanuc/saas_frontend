# v0.28 Board Migration Report

> –ó–≤—ñ—Ç –ø–æ –º—ñ–≥—Ä–∞—Ü—ñ—ó –¥–æ—à–∫–∏ –Ω–∞ Konva.js

## –î–∞—Ç–∞: 2025-12-13

## –†–µ–∑—é–º–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –º—ñ–≥—Ä–∞—Ü—ñ—é —Å–∏—Å—Ç–µ–º–∏ –¥–æ—à–æ–∫ –∑ HTML Canvas –Ω–∞ **Konva.js** —á–µ—Ä–µ–∑ **vue-konva**. –ù–æ–≤–∞ –¥–æ—à–∫–∞ –∑–∞–±–µ–∑–ø–µ—á—É—î –∫—Ä–∞—â—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, –ø—ñ–¥—Ç—Ä–∏–º–∫—É —à–∞—Ä—ñ–≤ —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ Vue 3 reactivity.

---

## 1. –ê—É–¥–∏—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–æ—à–æ–∫

### –°—Ç–∞—Ä–∞ –¥–æ—à–∫–∞ (SoloCanvas)

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –î—ñ—è |
|------|--------|-----|
| `src/modules/solo/views/SoloWorkspace.vue` | ‚ö†Ô∏è –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞—Ä—É | **–ü–æ—Ç—Ä–µ–±—É—î –∑–∞–º—ñ–Ω–∏** |
| `src/modules/solo/views/SoloPublicView.vue` | ‚ö†Ô∏è –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞—Ä—É | **–ü–æ—Ç—Ä–µ–±—É—î –∑–∞–º—ñ–Ω–∏** |
| `src/modules/solo/components/canvas/SoloCanvas.vue` | ‚úÖ –ü–µ—Ä–µ–ø–∏—Å–∞–Ω–æ –Ω–∞ Konva | –ì–æ—Ç–æ–≤–æ |

### –ù–æ–≤–∞ –¥–æ—à–∫–∞ (BoardCanvas/BoardDock)

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å |
|------|--------|
| `src/modules/classroom/views/SoloRoom.vue` | ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–æ–≤—É |
| `src/modules/classroom/views/LessonRoom.vue` | ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–æ–≤—É |
| `src/modules/classroom/components/board/BoardDock.vue` | ‚úÖ Konva |
| `src/modules/classroom/components/board/BoardCanvas.vue` | ‚úÖ Konva |

### –Ü–Ω—à—ñ –º–æ–¥—É–ª—ñ board

| –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º—ñ—Ç–∫–∞ |
|------|--------|----------|
| `src/modules/board/views/BoardView.vue` | ‚ö†Ô∏è –û–∫—Ä–µ–º–∏–π –º–æ–¥—É–ª—å | –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `@/stores/boardStore` |
| `src/modules/board/components/canvas/BoardCanvas.vue` | ‚ö†Ô∏è –û–∫—Ä–µ–º–∏–π –º–æ–¥—É–ª—å | –Ü–Ω—à–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è |
| `src/modules/lessons/views/LessonView.vue` | ‚ö†Ô∏è –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î BoardToolbar | –ü–æ—Ç—Ä–µ–±—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ |

---

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—ñ–≤

### –ú–æ–¥—É–ª—å `classroom/board` (–û–°–ù–û–í–ù–ò–ô)

```
src/modules/classroom/
‚îú‚îÄ‚îÄ components/board/
‚îÇ   ‚îú‚îÄ‚îÄ BoardCanvas.vue          # Konva canvas
‚îÇ   ‚îú‚îÄ‚îÄ BoardDock.vue            # –û–±–≥–æ—Ä—Ç–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ BoardToolbarVertical.vue # Toolbar
‚îÇ   ‚îú‚îÄ‚îÄ Subtoolbar.vue           # –ü—ñ–¥–ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ CloudStatus.vue          # –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ ExportMenu.vue           # –ï–∫—Å–ø–æ—Ä—Ç
‚îÇ   ‚îî‚îÄ‚îÄ icons/                   # SVG —ñ–∫–æ–Ω–∫–∏
‚îú‚îÄ‚îÄ board/state/
‚îÇ   ‚îî‚îÄ‚îÄ boardStore.ts            # Pinia store
‚îî‚îÄ‚îÄ views/
    ‚îú‚îÄ‚îÄ SoloRoom.vue             # Solo workspace (–Ω–æ–≤–∞)
    ‚îî‚îÄ‚îÄ LessonRoom.vue           # Lesson room
```

### –ú–æ–¥—É–ª—å `solo` (–ó–ê–°–¢–ê–†–Ü–õ–ò–ô)

```
src/modules/solo/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ canvas/SoloCanvas.vue    # –ü–µ—Ä–µ–ø–∏—Å–∞–Ω–æ –Ω–∞ Konva
‚îÇ   ‚îú‚îÄ‚îÄ toolbar/SoloToolbar.vue  # –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ footer/SoloFooter.vue    # –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π
‚îú‚îÄ‚îÄ composables/
‚îÇ   ‚îú‚îÄ‚îÄ useTools.ts              # –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ usePages.ts              # –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ useCanvas.ts             # –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π
‚îî‚îÄ‚îÄ views/
    ‚îú‚îÄ‚îÄ SoloWorkspace.vue        # –ü–æ—Ç—Ä–µ–±—É—î –∑–∞–º—ñ–Ω–∏
    ‚îî‚îÄ‚îÄ SoloPublicView.vue       # –ü–æ—Ç—Ä–µ–±—É—î –∑–∞–º—ñ–Ω–∏
```

### –ú–æ–¥—É–ª—å `board` (–û–ö–†–ï–ú–ò–ô)

```
src/modules/board/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ canvas/BoardCanvas.vue   # –Ü–Ω—à–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ toolbar/BoardToolbar.vue
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ composables/useBoard.ts
‚îî‚îÄ‚îÄ views/BoardView.vue
```

---

## 3. –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –ø–∞–∫–µ—Ç–∏

```json
{
  "konva": "^10.0.12",
  "vue-konva": "^3.2.6",
  "perfect-freehand": "^1.2.2"
}
```

### –ì–ª–æ–±–∞–ª—å–Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è

```js
// src/main.js
import VueKonva from 'vue-konva'
app.use(VueKonva)
```

---

## 4. –í–∏–∫–æ–Ω–∞–Ω—ñ –∑–º—ñ–Ω–∏

### 4.1 SoloCanvas.vue

- ‚ùå –í–∏–¥–∞–ª–µ–Ω–æ HTML Canvas —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é
- ‚úÖ –î–æ–¥–∞–Ω–æ Konva –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ (`v-stage`, `v-layer`, `v-line`, `v-rect`, `v-text`)
- ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ `perfect-freehand` –¥–ª—è –ø–ª–∞–≤–Ω–∏—Ö –ª—ñ–Ω—ñ–π
- ‚úÖ –î–æ–¥–∞–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º–∫—É —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤: pen, highlighter, eraser, line, rectangle, text

### 4.2 main.js

- ‚úÖ –î–æ–¥–∞–Ω–æ `app.use(VueKonva)` –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ—ó —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤

### 4.3 BoardToolbarVertical.vue

- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É –ø–∞–Ω–µ–ª—å —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ (Kami-style)
- ‚úÖ –†–æ–∑–º—ñ—Ä–∏ –∑–≥—ñ–¥–Ω–æ –¢–ó: 48px width, buttons 40√ó40, icons 20√ó20
- ‚úÖ Mobile: 44px width, buttons 36√ó36, icons 18√ó18

### 4.4 Subtoolbar.vue

- ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ –ø—ñ–¥–ø–∞–Ω–µ–ª—å –¥–ª—è —Ç–æ–≤—â–∏–Ω–∏ —Ç–∞ –∫–æ–ª—å–æ—Ä—É
- ‚úÖ Preset sizes: 1, 2, 4, 8 px
- ‚úÖ Preset colors: #111111, #22c55e, #e879f9, #2563eb, #eab308

---

## 5. –ü–æ—Ç—Ä–µ–±—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

### 5.1 SoloWorkspace.vue

**–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

**–ü–æ—Ç—Ä—ñ–±–Ω–æ:**
1. –ó–∞–º—ñ–Ω–∏—Ç–∏ `SoloToolbar` ‚Üí `BoardToolbarVertical`
2. –ó–∞–º—ñ–Ω–∏—Ç–∏ `SoloCanvas` ‚Üí `BoardDock`
3. –ó–∞–º—ñ–Ω–∏—Ç–∏ `SoloFooter` ‚Üí Footer –∑ `SoloRoom.vue`
4. –ó–∞–º—ñ–Ω–∏—Ç–∏ `useTools/usePages` ‚Üí `useBoardStore`
5. –û–Ω–æ–≤–∏—Ç–∏ handlers –¥–ª—è –Ω–æ–≤–∏—Ö –ø–æ–¥—ñ–π

### 5.2 SoloPublicView.vue

**–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `SoloCanvas` –≤ readonly —Ä–µ–∂–∏–º—ñ

**–ü–æ—Ç—Ä—ñ–±–Ω–æ:**
1. –ó–∞–º—ñ–Ω–∏—Ç–∏ `SoloCanvas` ‚Üí `BoardDock` –∑ `readonly=true`
2. –ê–¥–∞–ø—Ç—É–≤–∞—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–µ—Å—ñ—ó

### 5.3 –ú–æ–¥—É–ª—å board

**–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω:** –û–∫—Ä–µ–º–∏–π –º–æ–¥—É–ª—å –∑ –≤–ª–∞—Å–Ω–æ—é —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—î—é

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –£–Ω—ñ—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∑ `classroom/board` –∞–±–æ –≤–∏–¥–∞–ª–∏—Ç–∏

---

## 6. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è

| –ú–∞—Ä—à—Ä—É—Ç | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –î–æ—à–∫–∞ |
|---------|-----------|-------|
| `/solo/new` | `SoloWorkspace.vue` | ‚ö†Ô∏è –°—Ç–∞—Ä–∞ |
| `/solo/:id` | `SoloWorkspace.vue` | ‚ö†Ô∏è –°—Ç–∞—Ä–∞ |
| `/solo/shared/:token` | `SoloPublicView.vue` | ‚ö†Ô∏è –°—Ç–∞—Ä–∞ |
| `/classroom/solo` | `SoloRoom.vue` | ‚úÖ –ù–æ–≤–∞ |
| `/classroom/:sessionId` | `LessonRoom.vue` | ‚úÖ –ù–æ–≤–∞ |

---

## 7. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### Unit Tests

```
‚úì 49 test files passed
‚úì 702 tests passed
```

### Build

```
‚úì vite build completed in 7.99s
‚úì 2194 modules transformed
```

---

## 8. –ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –º–æ–¥—É–ª—è

### –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ classroom/board

| –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å | –¢–∏–ø | –ö—Ä–∏—Ç–∏—á–Ω—ñ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------------|-----|-------------|--------|
| `vue-konva` | npm | –û–±–æ–≤'—è–∑–∫–æ–≤–∞ | ‚úÖ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ |
| `konva` | npm | –û–±–æ–≤'—è–∑–∫–æ–≤–∞ | ‚úÖ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ |
| `perfect-freehand` | npm | –û–±–æ–≤'—è–∑–∫–æ–≤–∞ | ‚úÖ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ |
| `@/modules/solo/api/soloApi` | internal | –°–µ—Ä–µ–¥–Ω—è | ‚ö†Ô∏è –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å |
| `@/modules/solo/types/solo` | internal | –ù–∏–∑—å–∫–∞ | ‚ö†Ô∏è –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å |
| `@/utils/notify` | internal | –ù–∏–∑—å–∫–∞ | ‚ö†Ô∏è –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å |
| `@/i18n` | internal | –ù–∏–∑—å–∫–∞ | ‚ö†Ô∏è –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å |

### –ê–Ω–∞–ª—ñ–∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π boardStore.ts

```typescript
// –ü–æ—Ç–æ—á–Ω—ñ —ñ–º–ø–æ—Ä—Ç–∏:
import { soloApi } from '@/modules/solo/api/soloApi'
import { notifyError, notifySuccess } from '@/utils/notify'
import { i18n } from '@/i18n'
import type { SoloSession } from '@/modules/solo/types/solo'
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –ø–æ–≤–Ω–æ—ó –Ω–µ–∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

1. **soloApi** ‚Äî –≤–∏–Ω–µ—Å—Ç–∏ API-–º–µ—Ç–æ–¥–∏ –¥–æ—à–∫–∏ –≤ –æ–∫—Ä–µ–º–∏–π `@/modules/classroom/board/api/boardApi.ts`:
   ```typescript
   // –ó–∞–º—ñ—Å—Ç—å:
   import { soloApi } from '@/modules/solo/api/soloApi'
   // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
   import { boardApi } from './api/boardApi'
   ```

2. **notify** ‚Äî –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ emit events –∞–±–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ callback:
   ```typescript
   // –ó–∞–º—ñ—Å—Ç—å:
   notifyError('Error message')
   // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
   this.$emit('error', 'Error message')
   // –∞–±–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ options:
   options.onError?.('Error message')
   ```

3. **i18n** ‚Äî –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ props –∞–±–æ options:
   ```typescript
   // –ó–∞–º—ñ—Å—Ç—å:
   i18n.global.t('key')
   // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
   options.translate?.('key') || 'key'
   ```

4. **SoloSession type** ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤–ª–∞—Å–Ω–∏–π —Ç–∏–ø `BoardSession`:
   ```typescript
   // –ó–∞–º—ñ—Å—Ç—å:
   import type { SoloSession } from '@/modules/solo/types/solo'
   // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
   import type { BoardSession } from './types'
   ```

### –í–∏—Å–Ω–æ–≤–æ–∫

–ú–æ–¥—É–ª—å `classroom/board` **—á–∞—Å—Ç–∫–æ–≤–æ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–π**:
- ‚úÖ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ (BoardCanvas, BoardDock, BoardToolbar) –Ω–µ –º–∞—é—Ç—å –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- ‚ö†Ô∏è boardStore.ts –º–∞—î –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ solo –º–æ–¥—É–ª—è —Ç–∞ —É—Ç–∏–ª—ñ—Ç
- üìã –î–ª—è –ø–æ–≤–Ω–æ—ó –Ω–µ–∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ ~2-4 –≥–æ–¥–∏–Ω–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É

---

## 9. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- ‚úÖ `docs/board-integration.md` ‚Äî –≥–∞–π–¥ –ø–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó
- ‚úÖ `docs/reports/v0.28-board-migration-report.md` ‚Äî —Ü–µ–π –∑–≤—ñ—Ç

---

## 10. –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. [ ] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ `SoloWorkspace.vue` –Ω–∞ –Ω–æ–≤—É –¥–æ—à–∫—É
2. [ ] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ `SoloPublicView.vue` –Ω–∞ –Ω–æ–≤—É –¥–æ—à–∫—É
3. [ ] –í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –∑ `solo/components`
4. [ ] –£–Ω—ñ—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª–∏—Ç–∏ –º–æ–¥—É–ª—å `board`
5. [ ] –û–Ω–æ–≤–∏—Ç–∏ —Ç–µ—Å—Ç–∏ –¥–ª—è –Ω–æ–≤–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
6. [ ] –ü—Ä–æ–≤–µ—Å—Ç–∏ E2E —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

---

## –ê–≤—Ç–æ—Ä

Cascade AI Assistant

## –í–µ—Ä—Å—ñ—è

v0.28
